#include <stdio.h>
#include <stdlib.h>
#include <assert.h>
#include <string.h>

#include "tool.h"

static u32 micron_19_microcode_table[] = {
	0x00500001,
	0x04892001,
	0x000100EF,
	0xA0000050,
	0x00000400,
	0x00500001,
	0x0400A000,
	0x00020000,
	0x00010003,
	0x20020050,
	0x00EF0489,
	0x00500001,
	0x0400A000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00020A14,
	0x00010003,
	0x20030050,
	0x00EF0489,
	0x00500001,
	0x0400A000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00020A14,
	0x00010003,
	0x20040050,
	0x00EF0489,
	0x00500001,
	0x0400A000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00020A14,
	0x00010003,
	0x20050050,
	0x00EF0489,
	0x00500001,
	0x0400A000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00020A14,
	0x00010003,
	0x20060050,
	0x00EF0489,
	0x00500001,
	0x0400A000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00020A14,
	0x00010003,
	0x20070050,
	0x00EF0489,
	0x00500001,
	0x0400A000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00020A14,
	0x00010003,
	0x20080050,
	0x00EF0489,
	0x00500001,
	0x0400A000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00020A14,
	0x00010003,
	0x200C0050,
	0x00EF0489,
	0x00500001,
	0x0400A000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00020A14,
	0x00010003,
	0x20000050,
	0x00EF0489,
	0x00500001,
	0x0400A000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x0000000F
};

static u32 toshiba_a19_microcode_table[] = {
	0xC5500001,
	0x00006000,
	0x0001005C,
	0x20040050,
	0x00550104,
	0x00500001,
	0x01052004,
	0x00010055,
	0x207C0050,
	0x00550106,
	0x00500001,
	0x0107207D,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x20000050,
	0x00550104,
	0x00500001,
	0x0105207C,
	0x00010055,
	0x20780050,
	0x00550106,
	0x00500001,
	0x01072078,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00011534,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x0104207C,
	0x00010055,
	0x20760050,
	0x00550105,
	0x00500001,
	0x01062074,
	0x00010055,
	0x20720050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x15340055,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x20080050,
	0x00550104,
	0x00500001,
	0x01052008,
	0x00010055,
	0x20000050,
	0x00550106,
	0x00500001,
	0x01072000,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00011534,
	0x20000050,
	0x00B30000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x200B0050,
	0x00550104,
	0x00500001,
	0x0105207E,
	0x00010055,
	0x20760050,
	0x00550106,
	0x00500001,
	0x01072074,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00011534,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x01042010,
	0x00010055,
	0x20760050,
	0x00550105,
	0x00500001,
	0x01062072,
	0x00010055,
	0x20700050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x15340055,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x20020050,
	0x00550104,
	0x00500001,
	0x0105207C,
	0x00010055,
	0x207E0050,
	0x00550106,
	0x00500001,
	0x01072070,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00011534,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x01042014,
	0x00010055,
	0x20740050,
	0x00550105,
	0x00500001,
	0x01062000,
	0x00010055,
	0x206E0050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x15340055,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x20050050,
	0x00550104,
	0x00500001,
	0x01052078,
	0x00010055,
	0x20760050,
	0x00550106,
	0x00500001,
	0x01072074,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00011534,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x0104200A,
	0x00010055,
	0x200B0050,
	0x00550105,
	0x00500001,
	0x01062004,
	0x00010055,
	0x20040050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x15340055,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x20000050,
	0x00550104,
	0x00500001,
	0x01052000,
	0x00010055,
	0x20000050,
	0x00550106,
	0x00500001,
	0x01072000,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00F00001,
	0x00002000,
	0x01FE0000,
	0x0000000F
};

static u32 toshiba_a19_128gb_microcode_table[] = {
	0xC5500001,
	0x00006000,
	0x0001005C,
	0x20040050,
	0x00550104,
	0x00500001,
	0x01052004,
	0x00010055,
	0x207C0050,
	0x00550106,
	0x00500001,
	0x01072000,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x200C0050,
	0x00550104,
	0x00500001,
	0x01052006,
	0x00010055,
	0x20780050,
	0x00550106,
	0x00500001,
	0x01072078,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00011534,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x0104207C,
	0x00010055,
	0x20000050,
	0x00550105,
	0x00500001,
	0x01062074,
	0x00010055,
	0x20760050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x15340055,
	0x5D500001,
	0x00006000,
	0x000200CD,
	0x00010003,
	0x20140050,
	0x00550104,
	0x00500001,
	0x01052008,
	0x00010055,
	0x20000050,
	0x00550106,
	0x00500001,
	0x01072000,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00011534,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x0104201C,
	0x00010055,
	0x20040050,
	0x00550105,
	0x00500001,
	0x0106207A,
	0x00010055,
	0x20780050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x15340055,
	0x5D500001,
	0x00006000,
	0x000200CD,
	0x00010003,
	0x20020050,
	0x00550104,
	0x00500001,
	0x01052078,
	0x00010055,
	0x20760050,
	0x00550106,
	0x00500001,
	0x01072074,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00011534,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x01042008,
	0x00010055,
	0x20760050,
	0x00550105,
	0x00500001,
	0x01062072,
	0x00010055,
	0x20720050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x15340055,
	0x00500001,
	0x00002000,
	0x000100B3,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x01042010,
	0x00010055,
	0x207C0050,
	0x00550105,
	0x00500001,
	0x01062070,
	0x00010055,
	0x20760050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x15340055,
	0x5D500001,
	0x00006000,
	0x000200CD,
	0x00010003,
	0x20180050,
	0x00550104,
	0x00500001,
	0x01052006,
	0x00010055,
	0x20080050,
	0x00550106,
	0x00500001,
	0x01072076,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00011534,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x01042018,
	0x00010055,
	0x20060050,
	0x00550105,
	0x00500001,
	0x01062008,
	0x00010055,
	0x20760050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x15340055,
	0x5D500001,
	0x00006000,
	0x000200CD,
	0x00010003,
	0x20000050,
	0x00550104,
	0x00500001,
	0x01052000,
	0x00010055,
	0x20000050,
	0x00550106,
	0x00500001,
	0x01072000,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x00F00001,
	0x00002000,
	0x01FE0000,
	0x0000000F
};

static u32 toshiba_19_microcode_table[] = {
	0xC5500001,
	0x00006000,
	0x0001005C,
	0x20040050,
	0x00550104,
	0x00500001,
	0x01052004,
	0x00010055,
	0x20040050,
	0x00550106,
	0x00500001,
	0x01072004,
	0x00010055,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x01042008,
	0x00010055,
	0x20080050,
	0x00550105,
	0x00500001,
	0x01062008,
	0x00010055,
	0x20080050,
	0x00550107,
	0x00010AC4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x01042000,
	0x00010055,
	0x20000050,
	0x00550105,
	0x00500001,
	0x01062000,
	0x00010055,
	0x20000050,
	0x00550107,
	0x00010AC4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x01042078,
	0x00010055,
	0x20780050,
	0x00550105,
	0x00500001,
	0x01062078,
	0x00010055,
	0x20780050,
	0x00550107,
	0x00010AC4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x01042078,
	0x00010055,
	0x20780050,
	0x00550105,
	0x00500001,
	0x01062078,
	0x00010055,
	0x20700050,
	0x00550107,
	0x00010AC4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x0104200C,
	0x00010055,
	0x200C0050,
	0x00550105,
	0x00500001,
	0x0106200C,
	0x00010055,
	0x200C0050,
	0x00550107,
	0x00010AC4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x01042000,
	0x00010055,
	0x20000050,
	0x00550105,
	0x00500001,
	0x01062000,
	0x00010055,
	0x20000050,
	0x00550107,
	0x00F00001,
	0x00002000,
	0x01FE0000,
	0x0000000F,
};

static u32 toshiba_15_microcode_table[] = {
	0xC5500001,
	0x00006000,
	0x0001005C,
	0x20000050,
	0x00550104,
	0x00500001,
	0x01052000,
	0x00010055,
	0x20000050,
	0x00550106,
	0x00500001,
	0x01072000,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x20020050,
	0x00550104,
	0x00500001,
	0x01052004,
	0x00010055,
	0x20020050,
	0x00550106,
	0x00500001,
	0x01072000,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x000114E4,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x0104207C,
	0x00010055,
	0x20000050,
	0x00550105,
	0x00500001,
	0x0106207C,
	0x00010055,
	0x207C0050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x14E40055,
	0x5D500001,
	0x00006000,
	0x000200CD,
	0x00010003,
	0x207A0050,
	0x00550104,
	0x00500001,
	0x0105207C,
	0x00010055,
	0x207A0050,
	0x00550106,
	0x00500001,
	0x0107207C,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x000114E4,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x01042078,
	0x00010055,
	0x20000050,
	0x00550105,
	0x00500001,
	0x01062078,
	0x00010055,
	0x207A0050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x14E40055,
	0x5D500001,
	0x00006000,
	0x000200CD,
	0x00010003,
	0x207E0050,
	0x00550104,
	0x00500001,
	0x01052002,
	0x00010055,
	0x207E0050,
	0x00550106,
	0x00500001,
	0x0107207A,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x000114E4,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x01042076,
	0x00010055,
	0x20040050,
	0x00550105,
	0x00500001,
	0x01062076,
	0x00010055,
	0x20020050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x14E40055,
	0x5D500001,
	0x00006000,
	0x000200CD,
	0x00010003,
	0x20040050,
	0x00550104,
	0x00500001,
	0x01052000,
	0x00010055,
	0x20040050,
	0x00550106,
	0x00500001,
	0x01072078,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x000114E4,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x01042006,
	0x00010055,
	0x20000050,
	0x00550105,
	0x00500001,
	0x01062006,
	0x00010055,
	0x20760050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x14E40055,
	0x5D500001,
	0x00006000,
	0x000200CD,
	0x00010003,
	0x20740050,
	0x00550104,
	0x00500001,
	0x0105207C,
	0x00010055,
	0x20740050,
	0x00550106,
	0x00500001,
	0x01072076,
	0x00010055,
	0x20000050,
	0x0055010D,
	0x000114E4,
	0x60005D50,
	0x00CD0000,
	0x00030002,
	0x00500001,
	0x01042000,
	0x00010055,
	0x20000050,
	0x00550105,
	0x00500001,
	0x01062000,
	0x00010055,
	0x20000050,
	0x00550107,
	0x00500001,
	0x010D2000,
	0x00010055,
	0x200000F0,
	0x00000000,
	0x000F01FE,
};

static u32 sandisk_15_microcode_table[] = {
	0x00500001,
	0x04113000,
	0x000500EF,
	0x00000404,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x00010000,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x00007C7C,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x04040005,
	0x00007C7C,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x00000808,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x00000005,
	0x00007C7C,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x7C7C0808,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x04040005,
	0x00000408,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x04040000,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x7C7C0005,
	0x00007C00,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x04080808,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x040C0005,
	0x0000787C,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x78780000,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x0C0C0005,
	0x00000000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x00007878,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x7C7C0005,
	0x00000400,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x7C747878,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x7C7C0005,
	0x00007878,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x08040404,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x0C080005,
	0x00000408,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x08080808,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x78780005,
	0x00007878,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x007C7C7C,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x04080005,
	0x00000004,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x00080000,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x08040005,
	0x00000078,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x7C780C08,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x087C0005,
	0x00007874,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x74787C7C,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x00000005,
	0x00007474,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x08000000,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x78780005,
	0x0000747C,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00012DF4,
	0x60005D50,
	0x00260000,
	0x00030002,
	0x00500001,
	0x04113000,
	0x000500EF,
	0x74700478,
	0x00000000,
	0x00500001,
	0x0400A000,
	0x2DF40000,
	0x5D500001,
	0x00006000,
	0x00020026,
	0x00010003,
	0x30000050,
	0x00EF0411,
	0x00000005,
	0x00000000,
	0x00010000,
	0xA0000050,
	0x00000400,
	0x00F00001,
	0x00002000,
	0x01FE0000,
	0x0000000F,
};

void write_advanced_read_microcode(struct shannon_dev *dev)
{
	u32 *table, len;

	// printf("FPGA hw_version: %x\n", dev->hw_sysinfo->hw_version);

	if (dev->hw_sysinfo->hw_version < 5) {
		dev->has_advance_read = 0;
		return;
	}

	dev->has_advance_read = 1;

	if (le64_to_cpu(dev->flash->id.longid) == 0x0408d77a93953a98 ||
	    le64_to_cpu(dev->flash->id.longid) == 0x0c08d77a93953a98) {		// Toshiba 19nm 64GB
		table = toshiba_19_microcode_table;
		len = ARRAY_SIZE(toshiba_19_microcode_table);
	} else if (le64_to_cpu(dev->flash->id.longid) == 0x0408d07a93953a98) {	// Toshiba A19 64GB
		table = toshiba_a19_microcode_table;
		len = ARRAY_SIZE(toshiba_a19_microcode_table);
	} else if (le64_to_cpu(dev->flash->id.longid) == 0x0408d07e93a53c98) {	// Toshiba A19 128GB
		table = toshiba_a19_128gb_microcode_table;
		len = ARRAY_SIZE(toshiba_a19_128gb_microcode_table);
	} else if (le64_to_cpu(dev->flash->id.longid) == 0x04a53c64642c ||
		   le64_to_cpu(dev->flash->id.longid) == 0xa53c64842c ||
		   le64_to_cpu(dev->flash->id.longid) == 0x04a93ce5a42c ||
		   le64_to_cpu(dev->flash->id.longid) == 0xa954e5a42c) {
		table = micron_19_microcode_table;
		len = ARRAY_SIZE(micron_19_microcode_table);
	} else if (le64_to_cpu(dev->flash->id.longid) == 0x0408d17693943a98 ||
		   le64_to_cpu(dev->flash->id.longid) == 0x0408d17a93953c98) {
		table = toshiba_15_microcode_table;
		len = ARRAY_SIZE(toshiba_15_microcode_table);
	} else if (le64_to_cpu(dev->flash->id.longid) == 0x040a517a93953c45 ||
		   le64_to_cpu(dev->flash->id.longid) == 0x040a517693943a45) {
		table = sandisk_15_microcode_table;
		len = ARRAY_SIZE(sandisk_15_microcode_table);
	} else {
		dev->has_advance_read = 0;
		return;
	}

	dev->multi_iowrite32(dev, table, 0xC00, len);
}
